{% extends "two_factor/_base.html" %}
{% load static %}

{% block head %}
  {{ form.media }}
  <link rel="stylesheet" href="{% static 'two_factor/small_title.css' %}">
  <link rel="stylesheet" href="{% static 'two_factor/enable_labels.css' %}">
  <link rel="stylesheet" href="{% static 'two_factor/setup.css' %}">
{% endblock %}

{% block title %}Enable Two-Factor Authentication{% endblock %}
{% block form %}
  {% if wizard.steps.current == 'welcome' %}
    <p>You are about to take your account security to the next level. Follow the steps in this wizard to enable two-factor authentication.</p>
  {% elif wizard.steps.current == 'method' %}
    <p>Please select which authentication method you would like to use.</p>
  {% elif wizard.steps.current == 'generator' %}
    <p>To start using a token generator, please use an authenticator app on your smartphone to scan the QR code below. For example, use <a class="nice-link" href="https://play.google.com/store/apps/details?id=com.beemdevelopment.aegis">Aegis Authenticator</a> or <a class="nice-link" href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en">Google Authenticator</a> on Android, or <a class="nice-link" href="https://itunes.apple.com/us/app/google-authenticator/id388497605?mt=8">Google Authenticator</a> on iPhone.</p>
    <p><img src="{{ QR_URL }}" alt="QR Code" class="bg-white"/></p>
    <p>Alternatively you can use the following secret to setup TOTP in your authenticator or password manager manually if you can't or don't wish to use the QR code.</p>
    <p>TOTP Secret: <a class="nice-link" href="{{ otpauth_url }}">{{ secret_key }}</a></p>
    <p>Then, enter the token generated by the app below:</p>

  {% elif wizard.steps.current == 'sms' %}
    <p>Please enter the phone number you wish to receive the
      text messages on. This number will be validated in the next step.
      </p>
  {% elif wizard.steps.current == 'call' %}
    <p>Please enter the phone number you wish to be called on.
      This number will be validated in the next step. </p>
  {% elif wizard.steps.current == 'validation' %}
    {% if challenge_succeeded %}
      {% if device.method == 'call' %}
        <p>We are calling your phone right now, please enter the
          digits you hear.</p>
      {% elif device.method == 'sms' %}
        <p>We sent you a text message, please enter the tokens we
          sent.</p>
      {% endif %}
    {% else %}
      <p class="alert alert-warning" role="alert">We've encountered an issue with the selected authentication method. Please go back and verify that you entered your information correctly, try again, or use a different authentication method instead. If the issue persists, contact the site administrator.</p>
    {% endif %}
  {% elif wizard.steps.current == 'yubikey' %}
    <p>To identify and verify your YubiKey, please insert a token in the field below. Your YubiKey will be linked to your account.</p>
  {% endif %}

  <form action="" method="post">{% csrf_token %}
    {% include "two_factor/_wizard_forms.html" %}

    {# hidden submit button to enable [enter] key #}
    <input type="submit" value="" hidden />

    {% include "two_factor/_wizard_actions.html" %}
  </form>
{% endblock %}
